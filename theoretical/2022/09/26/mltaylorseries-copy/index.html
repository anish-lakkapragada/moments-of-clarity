<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Hidden Taylor Series in Theoretical Machine Learning &middot; Moments of Clarity
    
  </title>

  
  <link rel="canonical" href="https://anish.lakkapragada.com/theoretical/2022/09/26/mltaylorseries-copy/">
  

  <link rel="stylesheet" href="https://anish.lakkapragada.com/public/css/poole.css">
  <link rel="stylesheet" href="https://anish.lakkapragada.com/public/css/syntax.css">
  <link rel="stylesheet" href="https://anish.lakkapragada.com/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://anish.lakkapragada.com/public/apple-touch-icon-precomposed.png">
  <!-- <link rel="shortcut icon" href="https://anish.lakkapragada.com/public/favicon.ico"> -->

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://anish.lakkapragada.com/atom.xml">

  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'G-MY94EDEHE6', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>


  <body class="theme-base-custom">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Writings to describe the thoughts swirling in my head when they slow down and reformulate.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/">home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/about/">about</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/birdart/">art</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/birds/">birds</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/categories/">categories</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/contact/">leave a note</a>
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/ideas/">ideas</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/notes/">theoretical</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  </nav>

  <nav class="sidebar-nav">
      <details class="sidebar-nav-item"> 
        <summary> All Posts </summary>  
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/random/2024/02/26/firstpost/">First Post of 2024!</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/12/02/ring/">% Repeatable</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/songs/thinking/2023/11/10/mailinglist/">Mailing List?</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/songs/thinking/2023/11/08/worthalisten/">Worth A Listen?</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/10/06/fatd/">A Review: For All The Dogs</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/10/06/songs/">Lifetimes in 3 Minutes: Music</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/09/08/bruh/">Our World, In Distributions</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/songs/2023/08/18/trophies/">Trophies by Drake</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/08/15/perception/">Series of Philosophies</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/songs/2023/07/23/club-paradise/">Club Paradise by Drake</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/07/21/hardquestions/">A Hard Question (Partially) Answered, Badly</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/05/09/tests/">On The Value of Tests</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/05/04/what-could-go-wrong/">A Growing List of Lucky Things</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/04/28/reminded/">How did We Get Here?</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/03/24/why-I-enjoy-school/">Why I Enjoy School</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/birds/2023/03/14/birds-notes/">Bird Notes after a Year</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/random/2023/02/22/naps/">Naps</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/02/01/update/">Series of Observations</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2023/01/11/hedonistic-happy/">Hedonistic Treadmill: What It Means to Be Happy With What You Have</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/theoretical/2023/01/01/double-backprop/">Double Backpropagation: A Forgotten Algorithm</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2022/12/22/history/">PSA Reminder: History Actually Happened</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/random/2022/12/10/beards/">My Experience Growing a Beard, And Then Shaving It</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/random/2022/11/24/crawdads-tkam/">Comparison of Where The Crawdads Sing and To Kill a Mockingbird</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2022/11/09/word-association/">Food for Thought: Word Predictability</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/theoretical/2022/11/04/latex/">Why Does Latex look so good?</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/random/2022/10/24/act/">Falling Forward, Not Back: Drake</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/theoretical/2022/10/11/gradient-descent-euler/">Gradient Descent Revisited As Euler's Method</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/birds/2022/10/04/birdslist/">Photograph Birds List</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/theoretical/2022/09/26/mltaylorseries-copy/">Hidden Taylor Series in Theoretical Machine Learning</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/thinking/2022/09/25/paretoprinciple/">An explanation of Pareto's Principle</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/coding/2022/09/21/sveltevreact/">Yet Another Comparison of Svelte & React</a>
          
            <a class="sidebar-nav-item" href="https://anish.lakkapragada.com/theoretical/2022/09/20/closed-form-logreg/">Attempts at Closed-Form Logistic Regression</a>
          
      </details>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2024. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="home">Moments of Clarity</a>
            <small></small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true},
      jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
      extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js", "[Contrib]/a11y/accessibility-menu.js"],
      TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"],
      equationNumbers: {
      autoNumber: "AMS"
      }
    }
  });
</script>
<div class="post">
  <h1 class="post-title">Hidden Taylor Series in Theoretical Machine Learning</h1>
  <span class="post-date">26 Sep 2022</span>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true},
      jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
      extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js", "[Contrib]/a11y/accessibility-menu.js"],
      TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"],
      equationNumbers: {
      autoNumber: "AMS"
      }
    }
  });
</script>

<p><strong>Keywords: Taylor Series, Calculus, Gradient Descent, Polynomial Regression, Theoretical ML</strong></p>

<p>This article hopes to provide an alternate look at some of the most foundational algorithms in machine learning, namely Gradient Descent and Polynomial Regression, from an angle of Taylor Series.
Taylor Series are an extremely nice approximation method from calculus and are actually quite common in machine learning.</p>

<blockquote>
  <p>Machine Learning is about creating functions to model (i.e. approximate) functions in data - Taylor series is about approximating functions as well; it should come as no suprise that they are related in many cases.</p>
</blockquote>

<h2 id="taylor-series-primer">Taylor Series Primer</h2>

<p>So, what are taylor series? I won’t go into the proof here, because I don’t remember it and I don’t think its required, but the main detail is that Taylor Series are a way to approximate any function \(f(x)\) at a given point \(c\) using an infinite sum of polynomials. It’s formula is shown below:</p>

\[f(x)=\sum_{n=0}^\infty f^{(n)}(c)\frac{(x-c)^n}{n!} = f(c) + f^{(1)}(c)(x-c) + \dfrac{f^{(2)}(c)(x-c)^2}{2} + \ldots\]

<p>Where \(f^{(n)}(c)\) represents the \(n\)-th derivative (or just \(f(c)\) if \(n\) is 0), at a point of \(x=c\). Above, we only explicitly show the summation up to the second degree term - if we were to remove the other terms \(\ldots\), we would be left with the <em>second-degree approximation</em> of \(f(x)\). Using finite approximations of a taylor series will become important later, as infinite summations are not always possible in a computer.</p>

<p>On with the examples!</p>

<h2 id="taylor-series-in-gradient-descent">Taylor Series in Gradient Descent</h2>

<p><em>Before reading about the usage of Taylor Series in gradient descent, keep in mind that many different calculus concepts (not just taylor series!) play into gradient descent.</em></p>

<p>Gradient Descent is an iterative algorithm to generally optimize some function overtime based on its gradient (vector of partial derivatives.) The gradient yields a vector that tells the fastest way to ascend a curve - with gradient <em>descent</em> you try to go <em>down</em> the curve and thus constantly move in the negative of this gradient (moving with the positive is called gradient ascent). Gradient Descent is shown below.</p>

\[\theta_{t} = \theta_{t - 1} - \alpha * \nabla_{\theta_{t - 1}} J\]

<p>For more clarification, \(\theta_{t}\) are the parameters of the model (gradient descent is model agnostic, so this could range from linear regression to GPT-3) at a timestep \(t\) and \(\nabla_{\theta_{t - 1}} J\) represents the gradient of the objective function \(J\) that we are trying to minimize. It’s not shown, but \(J\) takes in the parameters \(x, y\) and \(\theta\).  As stated, we move in the direction of the negative of the gradient. \(\alpha\) is the learning rate and is applied to scale the gradient and prevent too high movements.</p>

<p>Gradient Descent can be re-thought of as finding some value \(\Delta \theta\) to adjust \(\theta_{t - 1}\) at each iteration \(t\) such that \(J(\theta_{t - 1} + \Delta \theta)\) is less than \(J(\theta_{t - 1})\). This is where taylor series come in - they help us find this required change. The taylor series to approximate the new value of the objective function to the first-degree is shown below.</p>

<blockquote>
  <p>Disclaimer: My linear algebra and multivariable calculus skills are kinda DNE, so please don’t try to inspect every term and make sure that the shapes all match up (probably missing a transpose here and there). Instead try to built intuition of the general approach.</p>
</blockquote>

\[J(\theta_{t - 1} + \Delta \theta) \approx J(\theta_{t - 1}) + \nabla_{\theta_{t - 1}} J * \Delta \theta\]

<p>This is a bit confusing, so let’s clarify, in this case the \(x\) in the approximation of \(f(x)\) is actually \(\theta_{t - 1} + \Delta \theta\) and thus the taylor series is centered at a point \(c\) of \(\theta_{t - 1}\). This means that the first-degree term \(x - c\) actually equals just \(\Delta \theta\).</p>

<p>This is where it gets clever. Given that we set \(J(\theta_{t - 1})\) or \(J(\theta_{t - 1} + \Delta \theta)\) to be less than \(J(\theta_{t - 1})\), to make both sides of the approximation equal, we basically need to find a way to balance the right and left side by reducing \(J(\theta_{t - 1})\) with negatives from the first-degree expression (\(\nabla_{\theta_{t - 1}} J * \Delta\theta\)) to it. We could just set \(\Delta \theta\) to \(-1\), but because \(\nabla_{\theta_{t - 1}} J\) is a matrix - there is no guarantee that all of the numbers inside of it will necessarily be the same sign. Thus we need to find some value of \(\Delta \theta\) that will make \(\nabla_{\theta_{t - 1}} J\) ALL negative.</p>

<p>This is actually much easier than expected. Just set \(\Delta \theta\) to the <em>negative</em> of \(\nabla_{\theta_{t - 1}} J\) and we guarantee all elements are negative (as a gradient squared yields all positive values.) This leads to the approximation having any chance of balancing out. As we add more degrees to the taylor polynomial, this approximation would keep on getting better.</p>

<p>This means that in our (minimization) algorithm of Gradient Descent, with \(\alpha\) for stability, we have:</p>

\[\theta_{t} = \theta_{t - 1} + \Delta \theta_{t - 1} = \theta_{t - 1} - \alpha * \nabla_{\theta_{t - 1}} J\]

<p>That’s gradient descent!</p>

<p>A lot of this information was taken from <a href="https://www.cs.princeton.edu/courses/archive/fall18/cos597G/lecnotes/lecture3.pdf">here</a> and summarized here. We can expand this method to actually include second and third derivatives as well - but those aren’t used as much due to requiring more computational power (sorry for the explanation that literally <em>everyone</em> gives.)</p>

<h2 id="taylor-series-in-polynomial-regression">Taylor Series in Polynomial Regression</h2>

<p>Weeee that was a lot of work for gradient descent! Luckily, applications of taylor series in polynomial regression is much more straightforward.</p>

<p>Polynomial regression is basically a type of linear regression where a single input (let’s stick to one-dimensional input for simplicity) is raised to higher powers and then the appropriate coefficients are found. The prediction function for a two-degree polynomial regression is shown below.</p>

\[\hat{y} = h(x) = \beta_{0} + \beta_{1}x + \beta_{2}x^{2}\]

<p>As shown above, \(\hat{y}\) are the predictions and \(\beta_{n}\) are the coefficients for \(x\) raised to the \(n\)-th power. Already looks like a taylor series (or maclaurin series as \(c = 0\)) right?</p>

<p>In fact, it is! It’s that simple. Let’s see if this actually works in practice.</p>

<h3 id="empirical-experiment-with-exponentials">Empirical Experiment with Exponentials</h3>

<p>Alliteration, huh? Okay, so the famous taylor series of the function \(e^{x}\) is shown below.</p>

\[e^{x} = \sum_{n = 0}^{\infty} \dfrac{x^{n}}{n!} = 1 + x + \dfrac{x^{2}}{2} + \ldots\]

<p>Will Polynomial Regression (to a degree of 2) actually learn this specific taylor series? To reiterate, if I train a Linear Regression model with <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html">scikit-learn</a>’s in Python, that takes in \(x\) and \(x^{2}\) as input - will it learn \({1, 1, 0.5}\) as \(\beta_{0}, \beta_{1}, \beta\_{2}\) respectively?</p>

<p>Will this taylor series be learned, from an algorithm derived from taylor series 🤯 ?</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="s">"""
we'll generate from a normal distribution as the
second-degree polynomial approximates best in this range.
"""</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="p">))</span> <span class="c1"># 1000 standard normal samples
</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">e</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span> <span class="c1"># labels
</span></code></pre></div></div>

<p>We can now construct the \(X^{2}\) data. We’ll merge into <code class="language-plaintext highlighter-rouge">X_poly</code> which will contain two columns - the first one for \(X\) and the second one for \(X^{2}\).</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">X_poly</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">X_2</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>Let’s apply Linear Regression.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lin_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span> <span class="c1"># lin reg algorithm
</span><span class="n">lin_reg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<p>Let’s inspect the coefficients \(\beta_{1}, \beta_{2}\).</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">lin_reg</span><span class="p">.</span><span class="n">coef_</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.24106858</span><span class="p">,</span>  <span class="mf">2.25427569</span><span class="p">])</span>
</code></pre></div></div>

<p>And the bias \(\beta_{0}\).</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">lin_reg</span><span class="p">.</span><span class="n">intercept_</span>
<span class="mf">1.5053263303981406</span>
</code></pre></div></div>

<p>Looks like it won’t.</p>

<p>My hypothesis is that if you use a higher-degree approximation (and of course have much more data), it will be more likely the coefficients will slowly fall in line with the <em>true</em> taylor polynomial. In our case, given that it only had a sample of \(e^{x}\) and not the whole infinite set of values, it is to be expected that not the precise values were found as these values actually could have minimized the mean-squared error more for this specific training set \(X\).</p>

<p>Also, if Polynomial Regression is a taylor series polynomial then linear regression is a first-degree taylor series?</p>

<h2 id="review">Review</h2>

<p>Congrats on making it here!</p>

<p>Taylor Series are a great way to approximate any function into polynomials. They have a lot of hidden applications in machine learning mathematics. We went over their role in helping determine how to move iteratively in Gradient Descent and it’s very clear application to Polynomial Regression.</p>

<p>Please let me know what more theoretical machine learning applications you find! Thanks for reading.</p>

</div>


<div class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/random/2024/02/26/firstpost/">
            First Post of 2024!
            <small>26 Feb 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/thinking/2023/12/02/ring/">
            % Repeatable
            <small>02 Dec 2023</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/songs/thinking/2023/11/10/mailinglist/">
            Mailing List?
            <small>10 Nov 2023</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

<style> 
  .title {
    font-style: italic;
  }
</style> 


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
